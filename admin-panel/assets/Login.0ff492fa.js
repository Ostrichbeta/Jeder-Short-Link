import{Q as u,a,d,b as c,c as f}from"./QPage.fe4daae0.js";import{_ as p,E as g,G as m,H as h,I as o,J as s,L as k,M as x,X as L}from"./index.c3cb6c00.js";import{a as i}from"./login-state.cb3efe2c.js";import{a as r}from"./axios.bf56c3c5.js";const _=g({name:"LoginPage",data(){return{tokenText:""}},methods:{async loginBtnClicked(t){if(this.tokenText=="")this.$q.notify("Token is required");else try{if((await r.post("/api/adminlogin",{},{headers:{Authorization:`Bearer ${this.tokenText}`},withCredentials:!0})).status==200){const n=i();n.isLogin=!0,this.$router.push("/accounts")}}catch(e){e.response&&e.response.status==403&&(this.$q.notify({message:"Login failed",color:"negative",timeout:5e3}),console.error(e))}}},async mounted(){const t=i();try{let e=await r.get("/api/getme",{withCredentials:!0});e.status!=200||e.data.user!="root"?t.isLogin=!1:t.isLogin=!0}catch{t.isLogin=!1}t.isLogin&&this.$router.push("/accounts")}}),y=L("div",{class:"text-h6"},"Login",-1);function C(t,e,n,q,w,$){return m(),h(u,{class:"flex column items-start content-center q-gutter-y-md q-pt-md q-px-lg q-px-md-none"},{default:o(()=>[s(f,{bordered:"",class:"my-card full-width",style:{"max-width":"800px"}},{default:o(()=>[s(a,null,{default:o(()=>[y]),_:1}),s(a,{class:"q-pt-none"},{default:o(()=>[k(" Login using the super token. ")]),_:1}),s(a,{class:"q-pt-none"},{default:o(()=>[s(d,{filled:"",modelValue:t.tokenText,"onUpdate:modelValue":e[0]||(e[0]=l=>t.tokenText=l),type:"password",label:"Token"},null,8,["modelValue"])]),_:1}),s(a,{class:"flex row justify-end items-center q-pt-none"},{default:o(()=>[s(c,{push:"",flat:""},{default:o(()=>[s(x,{label:"Login",onClick:t.loginBtnClicked},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})}var b=p(_,[["render",C]]);export{b as default};
