import{Q as u,a,d as c,b as p,c as f}from"./QPage.5243932f.js";import{_ as m,E as g,G as h,H as k,I as s,J as o,L as x,M as L,X as _}from"./index.6dff6d9f.js";import{a as i}from"./login-state.316deaee.js";import{a as r}from"./axios.bf56c3c5.js";const C="production",l=C.toLowerCase()=="development"?"http://localhost:3000":"",y=g({name:"LoginPage",data(){return{tokenText:""}},methods:{async loginBtnClicked(t){if(this.tokenText=="")this.$q.notify("Token is required");else try{if((await r.post(l+"/api/adminlogin",{},{headers:{Authorization:`Bearer ${this.tokenText}`},withCredentials:!0})).status==200){const n=i();n.isLogin=!0,this.$router.push("/accounts")}}catch(e){e.response&&e.response.status==403&&(this.$q.notify({message:"Login failed",color:"negative",timeout:5e3}),console.error(e))}}},async mounted(){const t=i();try{let e=await r.get(l+"/api/getme",{withCredentials:!0});e.status!=200||e.data.user!="root"?t.isLogin=!1:t.isLogin=!0}catch{t.isLogin=!1}t.isLogin&&this.$router.push("/accounts")}}),q=_("div",{class:"text-h6"},"Login",-1);function w(t,e,n,T,$,B){return h(),k(u,{class:"flex column items-start content-center q-gutter-y-md q-pt-md q-px-lg q-px-md-none"},{default:s(()=>[o(f,{bordered:"",class:"my-card full-width",style:{"max-width":"800px"}},{default:s(()=>[o(a,null,{default:s(()=>[q]),_:1}),o(a,{class:"q-pt-none"},{default:s(()=>[x(" Login using the super token. ")]),_:1}),o(a,{class:"q-pt-none"},{default:s(()=>[o(c,{filled:"",modelValue:t.tokenText,"onUpdate:modelValue":e[0]||(e[0]=d=>t.tokenText=d),type:"password",label:"Token"},null,8,["modelValue"])]),_:1}),o(a,{class:"flex row justify-end items-center q-pt-none"},{default:s(()=>[o(p,{push:"",flat:""},{default:s(()=>[o(L,{label:"Login",onClick:t.loginBtnClicked},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})}var b=m(y,[["render",w]]);export{b as default};
