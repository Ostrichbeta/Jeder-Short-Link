import{_ as C,I as L,K as x,L as q,M as n,T as s,N as i,S as d,aq as c,ar as _,as as o,at as V,au as p,V as T,av as k,w as h,aw as y,Q as S,U as b,P as m}from"./index.ad63fbe6.js";import{Q as U}from"./QResizeObserver.77c66b0e.js";import{Q as N,a as E}from"./QDate.f39e01b0.js";import{Q as R}from"./QPage.a3ab2378.js";import{C as w}from"./ClosePopup.368be68b.js";import{u as $}from"./userinfo.c70c4d68.js";import{a as f}from"./axios.bf56c3c5.js";import{s as Q}from"./sha256.6c01c987.js";const r=$(),A="production",g=A.toLowerCase()=="development"?"http://localhost:3000":"",D=L({name:"CreateLink",data(){return{newURL:"",parallaxHeight:0,foregroundSize:{},selTime:0,newSelTime:0,newLinkNeverExpire:!0,newName:"",dateTimePickerOpen:!1,showAdvancedSettings:!1,showLinkCreatedDlg:!1,generatedLink:"http://ost.vg/ssd"}},computed:{newLinkExpireTime(){return this.newLinkNeverExpire?-1:this.selTime}},async mounted(){try{let e=await f.get(g+"/acheck/profile",{withCredentials:!0});e.status==200&&e.data.status=="success"&&(r.isLoggedIn=!0,r.name=e.data.profile.name?e.data.profile.name:"",r.username=e.data.profile.username?e.data.profile.username:"");let t=await f.get(g+"/acheck/checkuser",{withCredentials:!0});if(t.status==200&&t.data.status=="success"){r.role=t.data.results[0].ROLE;let a=Q.exports.sha256(r.username);r.avatarImgSource=`https://gravatar.com/avatar/${a}?s=256&d=retro`;return}}catch(e){e.response&&(e.response.status==404?(r.role=-1,this.$router.push("/nopermission")):(this.$q.notify({message:`${e.response.data.reason}`,color:"negative"}),r.isLoggedIn=!1,this.$router.push("/login")))}},methods:{foregroundDivChanged(e){this.foregroundSize=e,this.parallaxHeight=(this.foregroundSize.height?this.foregroundSize.height:0)+96},onExpireFocus(e){e&&(e.target.blur(),this.newSelTime=(Math.ceil(Date.now()/1e3)*1e3).toString(),this.dateTimePickerOpen=!0)},onExpireTimeSet(e){this.selTime=parseInt(this.newSelTime)!=NaN?parseInt(this.newSelTime):0,this.newSelTime=0},onAdvancedBtnClick(e){this.showAdvancedSettings=!this.showAdvancedSettings,this.showAdvancedSettings||(this.newLinkNeverExpire=!0,this.newName="")},async createBtnClick(e){try{this.showAdvancedSettings||(this.newName=this.newURL.substring(0,20));let t=await f.get(g+"/api/userlinkcreate",{withCredentials:!0,params:{name:this.newName,target:this.newURL,expireat:this.newLinkExpireTime===-1?void 0:this.newLinkExpireTime}});t.status==200&&t.data.status=="success"&&(this.generatedLink="http://localhost:3000"+(t.data.source?t.data.source:""),this.showLinkCreatedDlg=!0)}catch(t){console.error(t),t.response&&this.$q.notify({message:`${t.response.data.reason}`,color:"negative"})}},formatTime(e){const t=(v,u=2)=>`${new Array(u).fill(0)}${v}`.slice(-u),a=new Date(e);return`${t(a.getFullYear(),4)}-${t(a.getMonth()+1)}-${t(a.getDate())} ${t(a.getHours())}:${t(a.getMinutes())}:${t(a.getSeconds())}`}}}),B={class:"column q-py-lg q-mt-none q-gutter-y-md flex items-center full-width content-center"},I={class:"full-width",ref:"foregrounddiv"},z=s("div",{class:"full-width"},[s("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"gt-xs text-center text-h3 text-white"},"Create a link ")],-1),O=s("div",{class:"full-width"},[s("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"gt-xs text-center text-h6 text-white"},"Just enter the URL and click the button!")],-1),P=s("div",{class:"full-width"},[s("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"xs text-center text-h5 text-white"},"Create a link")],-1),j=s("div",{class:"full-width"},[s("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"xs text-center text-body2 text-white"},"Just enter the URL and click the button!")],-1),F={class:"full-width row justify-center q-pt-md"},H={class:"col-10 gt-xs"},K={class:"q-mx-sm"},M={class:"col-8 xs"},J={class:"full-width row justify-center q-pt-lg"},Y={class:"q-mx-sm xs"},G={class:"q-mx-sm"},W={key:0,class:"full-width row justify-center q-pt-lg q-pb-md"},X={class:"col-10 col-sm-7"},Z=s("p",{class:"text-center text-h5"},"Advanced settings",-1),ee={class:"row"},te={class:"col-12 col-md-4 q-py-sm q-px-sm"},se={class:"col-12 col-md-4 q-py-sm q-px-sm"},ie={class:"col-12 col-md-4 q-py-sm q-px-sm content-center"},le=s("div",{class:"q-pt-none q-pb-xl"},null,-1),ne=s("div",{class:"text-h6"},"Select expire time",-1),ae=s("div",{class:"text-h5"},"Link Created",-1),oe=s("div",{class:"text-body1 q-pb-sm"},"Use this link to access",-1),re={class:"text-body-1 q-pb-xs"},de={class:"text-body-1 q-pb-xs"},ce=s("div",{class:"fixed-bottom-right text-white q-pb-sm q-pr-md"},[s("p",{class:"attribution q-ma-none text-caption",style:{"white-space":"nowrap"}},[m('"'),s("a",{rel:"noopener noreferrer",class:"text-white",href:"https://www.flickr.com/photos/69806124@N04/6775983965"},"Keyboard"),m('" by '),s("a",{rel:"noopener noreferrer",class:"text-white",href:"https://www.flickr.com/photos/69806124@N04"},"LawlessTech"),m(" is licensed under "),s("a",{rel:"noopener noreferrer",class:"text-white",href:"https://creativecommons.org/licenses/by/2.0/?ref=openverse"},[m("CC BY 2.0 "),s("img",{src:"https://mirrors.creativecommons.org/presskit/icons/cc.svg",style:{height:"0.75em","margin-right":"0.125em",display:"inline"}}),s("img",{src:"https://mirrors.creativecommons.org/presskit/icons/by.svg",style:{height:"0.75em","margin-right":"0.125em",display:"inline"}})])])],-1);function me(e,t,a,v,u,ue){return x(),q(R,{class:"flex column flex-center q-px-none q-px-md-none bg-image"},{default:n(()=>[s("div",B,[s("div",I,[z,O,P,j,s("div",F,[s("div",H,[i(c,{outlined:"",clearable:"",modelValue:e.newURL,"onUpdate:modelValue":t[0]||(t[0]=l=>e.newURL=l),"input-class":"text-h5","bg-color":"white"},{after:n(()=>[s("div",K,[i(d,{color:"primary",icon:"mdi-earth-plus",label:"Create",size:"lg",onClick:e.createBtnClick},null,8,["onClick"])])]),_:1},8,["modelValue"])]),s("div",M,[i(c,{outlined:"",clearable:"",modelValue:e.newURL,"onUpdate:modelValue":t[1]||(t[1]=l=>e.newURL=l),"input-class":"text-h6","bg-color":"white"},null,8,["modelValue"])])]),s("div",J,[s("div",Y,[i(d,{color:"primary",icon:"mdi-earth-plus",label:"Create",onClick:e.createBtnClick},null,8,["onClick"])]),s("div",G,[i(d,{color:"primary",icon:e.showAdvancedSettings?"mdi-chevron-up":"mdi-chevron-down",label:"Advanced",onClick:e.onAdvancedBtnClick},null,8,["icon","onClick"])])]),e.showAdvancedSettings?(x(),_("div",W,[s("div",X,[i(p,{class:"my-card",style:{"background-color":"rgba(250,250,250,.8)"}},{default:n(()=>[i(o,null,{default:n(()=>[Z]),_:1}),i(o,{class:"q-pt-none"},{default:n(()=>[s("div",ee,[s("div",te,[i(c,{filled:"",modelValue:e.newName,"onUpdate:modelValue":t[2]||(t[2]=l=>e.newName=l),label:"Name",rules:[l=>!!l||"Field Required"]},null,8,["modelValue","rules"])]),s("div",se,[i(c,{filled:"",modelValue:e.newLinkExpireTime,"onUpdate:modelValue":t[3]||(t[3]=l=>e.newLinkExpireTime=l),label:"Expire At",disable:e.newLinkNeverExpire,onFocus:e.onExpireFocus},null,8,["modelValue","disable","onFocus"])]),s("div",ie,[i(V,{modelValue:e.newLinkNeverExpire,"onUpdate:modelValue":t[4]||(t[4]=l=>e.newLinkNeverExpire=l),label:"Link never expires"},null,8,["modelValue"])])])]),_:1})]),_:1})])])):T("",!0),le,i(U,{onResize:e.foregroundDivChanged},null,8,["onResize"])],512)]),i(y,{modelValue:e.dateTimePickerOpen,"onUpdate:modelValue":t[7]||(t[7]=l=>e.dateTimePickerOpen=l),persistent:""},{default:n(()=>[i(p,{style:{"min-width":"350px","max-width":"70vw"}},{default:n(()=>[i(o,null,{default:n(()=>[ne]),_:1}),i(o,{class:"q-pt-none q-gutter-md row justify-center"},{default:n(()=>[i(N,{modelValue:e.newSelTime,"onUpdate:modelValue":t[5]||(t[5]=l=>e.newSelTime=l),mask:"x","with-seconds":""},null,8,["modelValue"]),i(E,{modelValue:e.newSelTime,"onUpdate:modelValue":t[6]||(t[6]=l=>e.newSelTime=l),mask:"x"},null,8,["modelValue"])]),_:1}),i(k,{align:"right",class:"q-pt-none text-primary"},{default:n(()=>[h(i(d,{flat:"",label:"Cancel"},null,512),[[w]]),h(i(d,{flat:"",label:"OK",onClick:e.onExpireTimeSet},null,8,["onClick"]),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(y,{modelValue:e.showLinkCreatedDlg,"onUpdate:modelValue":t[9]||(t[9]=l=>e.showLinkCreatedDlg=l)},{default:n(()=>[i(p,{style:{width:"300px"}},{default:n(()=>[i(o,{class:"row items-center justify-center q-pb-none"},{default:n(()=>[ae]),_:1}),i(o,{class:"row items-center justify-center q-pb-none"},{default:n(()=>[i(S,{name:"mdi-check-circle-outline",class:"text-primary",size:"70px"})]),_:1}),i(o,{class:"column items-center justify-center full-width q-pb-md"},{default:n(()=>[oe,i(c,{class:"full-width bg-orange-1",outlined:"",dense:"",modelValue:e.generatedLink,"onUpdate:modelValue":t[8]||(t[8]=l=>e.generatedLink=l),readonly:""},null,8,["modelValue"])]),_:1}),i(o,{class:"column full-width q-px-lg q-pt-none"},{default:n(()=>[s("div",re,"Name: "+b(e.newName),1),s("div",de,"Expire at: "+b(e.newLinkExpireTime==-1?"Never":e.formatTime(e.newLinkExpireTime)),1)]),_:1}),i(k,{align:"right",class:"q-pt-none text-primary"},{default:n(()=>[h(i(d,{flat:"",label:"OK"},null,512),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),ce]),_:1})}var ye=C(D,[["render",me]]);export{ye as default};
