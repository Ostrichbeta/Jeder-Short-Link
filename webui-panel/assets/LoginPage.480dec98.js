import{_ as h,I as p,K as m,L as u,M as r,T as e,N as a,S as f,as as d,Q as g,au as x,P as n}from"./index.5c8aeb45.js";import{Q as _}from"./QPage.568bd31f.js";import{a as i}from"./axios.bf56c3c5.js";import{u as w}from"./userinfo.6ef15d1c.js";import{s as y}from"./sha256.6c01c987.js";const o=w(),v="production",c=v.toLowerCase()=="development"?"http://localhost:3000":"",b=p({name:"NoPermission",data(){return{signInURL:c+"/auth/signin"}},computed:{},async mounted(){try{let t=await i.get(c+"/acheck/profile",{withCredentials:!0});t.status==200&&t.data.status=="success"&&(o.isLoggedIn=!0,o.name=t.data.profile.name?t.data.profile.name:"",o.username=t.data.profile.username?t.data.profile.username:"");let s=await i.get(c+"/acheck/checkuser",{withCredentials:!0});if(s.status==200&&s.data.status=="success"){o.role=s.data.results[0].ROLE;let l=y.exports.sha256(o.username);o.avatarImgSource=`https://gravatar.com/avatar/${l}?s=256&d=retro`,this.$router.push("/create");return}}catch(t){t.response&&(t.response.status==404?(o.role=-1,this.$router.push("/nopermission")):(t.response&&t.response.status!=401&&this.$q.notify({message:`${t.response.data.reason}`,color:"negative"}),o.isLoggedIn=!1))}},methods:{async checkPermissionBtnClick(t){try{let s=await i.get("http://localhost:3000/acheck/checkuser",{withCredentials:!0});s.status==200&&s.data&&s.data.status=="success"&&console.log(s.data)}catch(s){s.response&&this.$q.notify({message:`${s.response.data.reason}`,color:"negative"})}}}}),q={class:"column q-py-lg q-mt-none q-gutter-y-md flex items-center full-width content-center"},k={class:"full-width",ref:"foregrounddiv"},L=e("div",{class:"full-width"},[e("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"gt-xs text-center text-h3 text-white"},"Log in ")],-1),C=e("div",{class:"full-width"},[e("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"gt-xs text-center text-h6 text-white"},"Log in to Management Page")],-1),$=e("div",{class:"full-width"},[e("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"xs text-center text-h5 text-white"},"Log in")],-1),P=e("div",{class:"full-width"},[e("p",{style:{"text-shadow":"2px 2px #4c3d30"},class:"xs text-center text-body2 text-white"},"Log in to Management Page")],-1),I={class:"row full-width justify-center"},M={class:"row full-width justify-center q-pt-md"},Q={class:"row no-warp items-center"},R=e("div",{class:"text-h6 q-pl-sm"},"Why Microsoft?",-1),N=e("div",{class:"text-body2"}," This website uses Microsoft login to identify users. Once you\u2019re logged in, we can only get your email and name. ",-1),U=e("div",{class:"text-body2 q-pt-sm"},[e("b",null,"We won\u2019t ask for your password, so please take care of it!")],-1),B=e("div",{class:"text-body2 q-pt-sm text-negative"}," Only authorized Microsoft accounts can logged in and use our service. ",-1),z=e("div",{class:"text-body2 q-pt-sm"},[e("span",{lang:"zh-Hant"},"\u672C\u7DB2\u7AD9\u4F7F\u7528 Microsoft \u767B\u5165\u4F86\u8B58\u5225\u4F7F\u7528\u8005\u3002\u4E00\u65E6\u60A8\u767B\u5165\uFF0C\u6211\u5011\u53EA\u80FD\u53D6\u5F97\u60A8\u7684\u96FB\u5B50\u90F5\u4EF6\u548C\u59D3\u540D\u3002")],-1),T=e("div",{class:"text-body2 q-pt-sm"},[e("span",{lang:"zh-Hant"},[e("b",null,"\u6211\u5011\u4E0D\u6703\u8A62\u554F\u60A8\u7684\u5BC6\u78BC\uFF01")])],-1),H=e("div",{class:"text-body2 q-pt-sm text-negative"},[e("span",{lang:"zh-Hant"},"\u53EA\u6709\u6388\u6B0A\u7684 Microsoft \u5E33\u6236\u624D\u80FD\u767B\u5165\u4E26\u4F7F\u7528\u6211\u5011\u7684\u670D\u52D9\u3002")],-1),S=e("div",{class:"q-pt-none q-pb-xl"},null,-1),E=e("div",{class:"fixed-bottom-right text-white q-pb-sm q-pr-md"},[e("p",{class:"attribution q-ma-none text-caption",style:{"white-space":"nowrap"}},[n('"'),e("a",{rel:"noopener noreferrer",class:"text-white",href:"https://www.flickr.com/photos/69806124@N04/6775983965"},"Keyboard"),n('" by '),e("a",{rel:"noopener noreferrer",class:"text-white",href:"https://www.flickr.com/photos/69806124@N04"},"LawlessTech"),n(" is licensed under "),e("a",{rel:"noopener noreferrer",class:"text-white",href:"https://creativecommons.org/licenses/by/2.0/?ref=openverse"},[n("CC BY 2.0 "),e("img",{src:"https://mirrors.creativecommons.org/presskit/icons/cc.svg",style:{height:"0.75em","margin-right":"0.125em",display:"inline"}}),e("img",{src:"https://mirrors.creativecommons.org/presskit/icons/by.svg",style:{height:"0.75em","margin-right":"0.125em",display:"inline"}})])])],-1);function O(t,s,l,V,j,K){return m(),u(_,{class:"flex column flex-center q-px-none q-px-md-none bg-image"},{default:r(()=>[e("div",q,[e("div",k,[L,C,$,P,e("div",I,[a(f,{class:"q-mx-sm",href:t.signInURL,color:"primary",label:"Microsoft Login"},null,8,["href"])]),e("div",M,[a(x,{class:"my-card col-10 col-xs-9 col-sm-6 col-md-4",style:{"background-color":"rgba(250,250,250,.8)"}},{default:r(()=>[a(d,null,{default:r(()=>[e("div",Q,[a(g,{size:"md",name:"mdi-help-circle-outline",color:"primary"}),R])]),_:1}),a(d,{class:"q-pt-none"},{default:r(()=>[N,U,B,z,T,H]),_:1})]),_:1})])],512),S]),E]),_:1})}var G=h(b,[["render",O]]);export{G as default};
